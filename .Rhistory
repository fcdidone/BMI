geom_bar(stat="identity",position="stack",size=0.1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status))+ scale_size_identity()
geom_segment(stat="identity",position="stack",size=0.1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status))+ scale_size_identity()+
geom_segment(stat="identity",position="stack",size=0.1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=0.1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
data.frame(Status = c("Underweight","Normal","Overweight","Obese"),
BMI=c(18.5,7.5,5,20),id=rep("",4) )-> gr
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bl(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bk(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme(legend.position="top")+theme_bw()+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.8,0.5))+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.1,0.2))+
guides(fill=guide_legend(title=NULL))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.1,0.2))+
guides(fill=guide_legend(title=NULL,byrow = T))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.1,0.2))+
guides(fill=guide_legend(title=NULL,byrow = F))
lot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.1,0.2))+
guides(fill=guide_legend(title=NULL,byrow = TRUE))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.1,0.2))+
guides(fill=guide_legend(title=NULL,byrow = TRUE))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.1,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=27,xend=2))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=27,xend=1.2),size=2)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=25,xend=1.2),size=1.2, col="ligthblue")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=25,xend=1.2),size=1.2, col="blue")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=25,xend=1.2),size=1.2, arrow())
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=25,xend=1.2),size=1.2, arrow(length= unit(0.5,"cm")))
library(grid)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1,yend=25,xend=1.2),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
data.frame(Status = c("Underweight","Normal","Overweight","Obese"),
BMI=c(18.5,7.5,5,10),id=rep("",4) )-> gr
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+ylim(10,40)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+xlim(10,40)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ scale_size_identity()+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+ylim(10,40)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+ylim(10,40)+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1.1),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1.04),size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=25,x=1.2,yend=25,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))
18.5+7.5
data.frame(Status = c("Underweight","Normal","Overweight","Obese"),
BMI=c(18.5,6.5,5,10),id=rep("",4) )-> gr
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=25,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("Your BMI",x=1.2,y=24)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=25,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.2,y=24)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.22,y=24,col="orange",size=1.2)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.22,y=24,col="orange",size=3)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.22,y=24,col="orange",size=10)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)+
annotate("point",x=0.95,y=24)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)+
annotate("point",x=0.98,y=24)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)+
annotate("point",x=0.99,y=24,size=2)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)+
annotate("point",x=0.99,y=24,size=8)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)+
annotate("point",x=0.99,y=24,size=4,col=orange)
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6)+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.2))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.13))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.124))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.12))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.99,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=0.995,y=24,size=4,col="orange")
ggplot(data=gr,aes(x=id,y=BMI,fill=Status,width=0.1))+
geom_bar(stat="identity",position="stack",size=1)+coord_flip()+
scale_fill_brewer(type="div",palette="OrRd",breaks=c("Underweight","Normal","Overweight","Obese"))+
scale_x_discrete(name="")+theme_bw()+theme(legend.position="top")+theme(legend.position=c(0.5,0.2))+
guides(fill=guide_legend(title=NULL,nrow=1))+
geom_segment(aes(y=24,x=1.2,yend=24,xend=1.04),col="orange",size=1.2, arrow  =arrow(length= unit(0.5,"cm")))+
annotate("text", label= "Your BMI",x=1.23,y=24,col="orange",size=6,fontface="bold")+
annotate("point",x=1,y=24,size=4,col="orange")
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
?if
?"if"
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
shiny::runApp('C:/Coursera/BMI')
load("C:/Coursera/lmachine/env.R.RData")
pr$call
library(caret)
raft<- train(classe~.,data=train0,method="rf")
raft$times
predict(raft,train0)-> p2
confusionMatrix(p2,train0$classe)
varImp(raft)
raft$finalModel
raft$finalModel$p
getTree(raft$finalModel,k=4)
getTree(raft$finalModel,k=4) -> l
library(rattle)
fancyRpartPlot(l)
raft$finalModel
raft$dots
raft$xlevels
raft$terms
raft$perfNames
confusionMatrix(p2,train0$classe)
raft
plot(raft)
plot(raft$finalmodel)
plot(raft,log="y")
MDSplot(raft)
MDSplot(raft$finalModel)
varImp(raft)
plot(varImp(raft))
plot(varImp(raft,41))
plot(varImp(raft,10))
plot(varImp(raft),10)
to.dendrogram <- function(dfrep,rownum=1,height.increment=0.1){
if(dfrep[rownum,'status'] == -1){
rval <- list()
attr(rval,"members") <- 1
attr(rval,"height") <- 0.0
attr(rval,"label") <- dfrep[rownum,'prediction']
attr(rval,"leaf") <- TRUE
}else{##note the change "to.dendrogram" and not "to.dendogram"
left <- to.dendrogram(dfrep,dfrep[rownum,'left daughter'],height.increment)
right <- to.dendrogram(dfrep,dfrep[rownum,'right daughter'],height.increment)
rval <- list(left,right)
attr(rval,"members") <- attr(left,"members") + attr(right,"members")
attr(rval,"height") <- max(attr(left,"height"),attr(right,"height")) + height.increment
attr(rval,"leaf") <- FALSE
attr(rval,"edgetext") <- dfrep[rownum,'split var']
}
class(rval) <- "dendrogram"
return(rval)
}
tree<- getTree(raft,1,labelVar = T)
tree<- getTree(raft$finalModel,1,labelVar = T)
d <- to.dendrogram(tree)
plot(d,center=TRUE,leaflab='none',edgePar=list(t.cex=1,p.col=NA,p.lty=0))
print(rval)
print(raft)
print(raft$finalModel)
importance(raft$finalModel)
partialPlot(raft$finalModel,train0,roll_arm)
partialPlot(raft,train0,roll_arm)
plor(raft$finalModel,type="l")
plot(raft$finalModel,type="l")
treesize(raft$finalModel)
varUsed(raft$finalModel)
OOB.votes <- predict (raft$finalModel,train0$classe,type="prob")
OOB.votes <- predict (raft,train0$classe,type="prob")
OOB.votes <- predict (raft,train0$classe)
OOB.votes <- predict (raft,train0,type="prob")
OOV.Votes
OOB.Votes
OOB.votes
OOB.pred <- OOB.votes[,2]
pred.obj <- prediction (OOB.pred,train0)
install.packages("ROCR")
library(ROCR)
pred.obj <- prediction (OOB.pred,train0)
treesize(raft$finalModel)
importance(raft$finalModel)
raft
modFit <- train(Survived~ .,data=train,method="rf",prox=TRUE)
modFit <- train(Species~ .,data=train,method="rf",prox=TRUE)
str(irs)
str(iris)
data(iris); library(ggplot2)
inTrain <- createDataPartition(y=iris$Species,
p=0.7, list=FALSE)
training <- iris[inTrain,]
testing <- iris[-inTrain,]
modFit <- train(Species~ .,data=training,method="rf",prox=TRUE)
```{r centers, dependson="forestIris",fig.height=4,fig.width=4}
irisP <- classCenter(training[,c(3,4)], training$Species, modFit$finalModel$prox)
irisP <- as.data.frame(irisP); irisP$Species <- rownames(irisP)
p <- qplot(Petal.Width, Petal.Length, col=Species,data=training)
p + geom_point(aes(x=Petal.Width,y=Petal.Length,col=Species),size=5,shape=4,data=irisP)
save.image("C:/Coursera/lmachine/env.R.RData")
